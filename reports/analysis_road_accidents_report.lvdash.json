{
  "datasets": [
    {
      "name": "51e9d062",
      "displayName": "road_accidents",
      "queryLines": [
        "SELECT \n",
        "    *\n",
        "    ,concat_ws('-', accident_month, accident_year) AS accident_month_year\n",
        "    ,concat_ws('-', accident_day, accident_month, accident_year) AS accident_date\n",
        "FROM training.roaa_dev_analytics.road_accidents"
      ]
    },
    {
      "name": "a6a90040",
      "displayName": "accident_by_hour_per_year",
      "queryLines": [
        "SELECT\n",
        "  `accident_year`,\n",
        "  CAST(SPLIT(`accident_time`, ':')[0] AS INT) AS accident_hour,\n",
        "  COUNT(DISTINCT `accident_num`) AS accident_count\n",
        "FROM\n",
        "  `training`.`roaa_dev_analytics`.`road_accidents`\n",
        "WHERE\n",
        "  `accident_time` IS NOT NULL\n",
        "  AND `accident_year` IS NOT NULL\n",
        "GROUP BY\n",
        "  `accident_year`,\n",
        "  CAST(SPLIT(`accident_time`, ':')[0] AS INT)\n",
        "ORDER BY\n",
        "  `accident_year` ASC,\n",
        "  accident_hour ASC"
      ]
    }
  ],
  "pages": [
    {
      "name": "aaeee09b",
      "displayName": "Page 1",
      "layout": [
        {
          "widget": {
            "name": "883e8456",
            "multilineTextboxSpec": {
              "lines": [
                "## <span style=\"text-align:center;display:block\"><span style=\"font-size:24px\">Analyse des accidents de la route en France</span> par année</span>"
              ]
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 10,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "nombre-daccidents-par-annee-et-mois",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "51e9d062",
                  "fields": [
                    {
                      "name": "accident_month",
                      "expression": "`accident_month`"
                    },
                    {
                      "name": "accident_month_year",
                      "expression": "`accident_month_year`"
                    },
                    {
                      "name": "countdistinct(accident_num)",
                      "expression": "COUNT(DISTINCT `accident_num`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "frame": {
                "showTitle": true,
                "title": "Nombre d'accidents par mois et années"
              },
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "accident_month_year",
                  "displayName": "Mois",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "y": {
                  "fieldName": "countdistinct(accident_num)",
                  "displayName": "Nombre d'accidents",
                  "scale": {
                    "type": "quantitative"
                  }
                },
                "color": {
                  "fieldName": "accident_month",
                  "displayName": "Mois",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "label": {
                  "show": true
                }
              }
            }
          },
          "position": {
            "x": 0,
            "y": 1,
            "width": 12,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "repartition-par-region",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "51e9d062",
                  "fields": [
                    {
                      "name": "accident_year",
                      "expression": "`accident_year`"
                    },
                    {
                      "name": "ref_region_name",
                      "expression": "`ref_region_name`"
                    },
                    {
                      "name": "countdistinct(accident_num)",
                      "expression": "COUNT(DISTINCT `accident_num`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 1,
              "frame": {
                "showTitle": true,
                "title": "Répartition par région et par année"
              },
              "widgetType": "sankey",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(accident_num)"
                },
                "stages": [
                  {
                    "fieldName": "accident_year"
                  },
                  {
                    "fieldName": "ref_region_name"
                  }
                ]
              }
            }
          },
          "position": {
            "x": 6,
            "y": 6,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "nombre-daccidents-par-type-de-voies",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "51e9d062",
                  "fields": [
                    {
                      "name": "countdistinct(accident_num)",
                      "expression": "COUNT(DISTINCT `accident_num`)"
                    },
                    {
                      "name": "road_category",
                      "expression": "`road_category`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "frame": {
                "showTitle": true,
                "title": "Nombre d'accidents par type de voie"
              },
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "countdistinct(accident_num)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Répartition"
                },
                "color": {
                  "fieldName": "road_category",
                  "displayName": "Type de voie",
                  "scale": {
                    "type": "categorical"
                  }
                }
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "957e0148",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "51e9d062",
                  "fields": [
                    {
                      "name": "countdistinct(accident_num)",
                      "expression": "COUNT(DISTINCT `accident_num`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(accident_num)"
                }
              }
            }
          },
          "position": {
            "x": 10,
            "y": 0,
            "width": 2,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "2121f88d",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "51e9d062",
                  "fields": [
                    {
                      "name": "countdistinct(accident_num)",
                      "expression": "COUNT(DISTINCT `accident_num`)"
                    },
                    {
                      "name": "injury_severity",
                      "expression": "`injury_severity`"
                    }
                  ],
                  "filters": [
                    {
                      "expression": "`injury_severity` IN ('Blessé hospitalisé', 'Blessé léger', 'Indemne', 'Tué')"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "countdistinct(accident_num)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Répartition"
                },
                "color": {
                  "fieldName": "injury_severity",
                  "displayName": "Sévérité",
                  "scale": {
                    "type": "categorical"
                  }
                }
              }
            }
          },
          "position": {
            "x": 6,
            "y": 12,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "a5bb8298",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "a6a90040",
                  "fields": [
                    {
                      "name": "accident_year",
                      "expression": "`accident_year`"
                    },
                    {
                      "name": "accident_hour",
                      "expression": "`accident_hour`"
                    },
                    {
                      "name": "accident_count",
                      "expression": "`accident_count`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "frame": {
                "showTitle": true,
                "title": "Répartition des accidents par heure de la journée et par année"
              },
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "accident_hour",
                  "displayName": "Heures",
                  "scale": {
                    "type": "quantitative"
                  }
                },
                "y": {
                  "fieldName": "accident_count",
                  "displayName": "Nombre d'accident",
                  "scale": {
                    "type": "quantitative"
                  }
                },
                "color": {
                  "fieldName": "accident_year",
                  "displayName": "Années",
                  "scale": {
                    "type": "categorical"
                  }
                },
                "label": {
                  "show": false
                }
              }
            }
          },
          "position": {
            "x": 0,
            "y": 12,
            "width": 6,
            "height": 6
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS",
      "layoutVersion": "GRID_V1"
    },
    {
      "name": "3f6a7e52",
      "displayName": "Global Filters",
      "layout": [
        {
          "widget": {
            "name": "annee-en-cours",
            "queries": [
              {
                "name": "dashboards/01f10a6d4d5317c09f788bc03003ea80/datasets/01f10a9645931c358334e0b076bde387_accident_year",
                "query": {
                  "datasetName": "51e9d062",
                  "fields": [
                    {
                      "name": "accident_year",
                      "expression": "`accident_year`"
                    },
                    {
                      "name": "accident_year_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01f10a6d4d5317c09f788bc03003ea80/datasets/01f10abf15491f0ea2f33de1217cb3c6_accident_year",
                "query": {
                  "datasetName": "a6a90040",
                  "fields": [
                    {
                      "name": "accident_year",
                      "expression": "`accident_year`"
                    },
                    {
                      "name": "accident_year_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "frame": {
                "showTitle": true,
                "title": "Année en cours"
              },
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "accident_year",
                    "queryName": "dashboards/01f10a6d4d5317c09f788bc03003ea80/datasets/01f10a9645931c358334e0b076bde387_accident_year"
                  },
                  {
                    "fieldName": "accident_year",
                    "queryName": "dashboards/01f10a6d4d5317c09f788bc03003ea80/datasets/01f10abf15491f0ea2f33de1217cb3c6_accident_year"
                  }
                ]
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 1,
            "height": 2
          }
        }
      ],
      "pageType": "PAGE_TYPE_GLOBAL_FILTERS",
      "layoutVersion": "GRID_V1"
    }
  ],
  "uiSettings": {
    "theme": {
      "widgetHeaderAlignment": "ALIGNMENT_UNSPECIFIED"
    },
    "applyModeEnabled": false
  }
}
